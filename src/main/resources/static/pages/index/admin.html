<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../assets/css/adminindex.css">
    <link rel="stylesheet" href="../../assets/css/element-ui/index.css">
    <link rel="shortcut icon" href="../../assets/pics/logo2.png">
    <title>管理员页面</title>
</head>
<body>
<div id="app">
    <el-container>
        <el-header style="height: 80px">
            <!--					TODO: 假的，需要加token后续实现-->

        <!--logo-->

        <div class="head" style="float: left;">
            <el-avatar :src="avatarURL">
            </el-avatar>
        </div>
        <div class="logo" style="font-size: 25px;width: 300px;padding-top:5px;">汇安智能仓储平台</div>

        <!--头像-->
        <div class="avatar" style="float: right;">
            <el-button @click="drawer = true" circle >
                <el-avatar src="https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png">
                </el-avatar>

            </el-button>

            <el-drawer
                    title="个人主页"
                    :visible.sync="drawer"
                    size="50%">
                <div>
                    <el-button @click="innerDrawer = true">打开里面的!</el-button>
                    <el-drawer
                            title="我是里面的"
                            :append-to-body="true"
                            :before-close="handleClose"
                            :visible.sync="innerDrawer">
                        <p>_(:зゝ∠)_</p>
                    </el-drawer>
                </div>
            </el-drawer>
        </div>
        </el-header>


        <el-container>
            <!--侧边栏-->
            <el-aside width="auto">
                <el-menu class="el-menu-vertical-demo" default-active="1" style="height: 110vh;"
                         background-color="#FFFFFF" text-color="#000000" active-text-color="#409EFF"
                         @open="handleOpen" @close="handleClose" :collapse="isCollapse">
                    <el-radio-group v-model="isCollapse">
                        <el-radio-button :label="false" v-if="isCollapse" size="medium" style="float:left;"><i class="el-icon-d-arrow-right"></i>
                        </el-radio-button>
                        <el-radio-button :label="true" v-else size="medium"><i class="el-icon-d-arrow-left"></i>
                        </el-radio-button>
                    </el-radio-group>

                    <el-menu-item index="1" >
                        <i class="el-icon-menu"></i>
                        <span slot="title" @click="openUrl('./index.html')">主页</span>
                    </el-menu-item>


							<el-menu-item index="2" >
								<i class="el-icon-s-help"></i>
								<span slot="title"  @click="openUrl('./charts.html')" style="">控制台</span>
							</el-menu-item>
							<el-submenu index="3" >
								<template slot="title">
									<i class="el-icon-view"></i>
									<span slot="title" >业务流</span>
								</template>
								<el-menu-item-group>
									<el-menu-item index="3-1">
										<i class="el-icon-user"></i>
										<span slot="title" @click="openUrl('../admin/users.html')">用户管理</span>
									</el-menu-item>
									<el-menu-item index="3-2">
										<i class="el-icon-s-home"></i>
										<span slot="title" @click="openUrl('../admin/warehouse.html')">仓库管理</span>
									</el-menu-item>
									<el-menu-item index="3-3">
										<i class="el-icon-goods"></i>
										<span slot="title" @click="openUrl('../admin/goods.html')">货物管理</span>
									</el-menu-item>
									<el-menu-item index="3-4">
										<i class="el-icon-s-order"></i>
										<span slot="title" @click="openUrl('../admin/orders.html')">订单管理</span>
									</el-menu-item>
									<el-menu-item index="3-5">
										<i class="el-icon-takeaway-box"></i>
										<span slot="title" @click="openUrl('../admin/inventory.html')">库存管理</span>
									</el-menu-item>

								</el-menu-item-group>
							</el-submenu>
							<el-menu-item index="5">
								<i class="el-icon-setting"></i>
								<span slot="title">系统设置</span>
							</el-menu-item>
							<el-menu-item index="6">
								<i class="el-icon-warning-outline"></i>
								<span slot="title" @click="logout">退出登录</span>
							</el-menu-item>
						</el-menu>
					</el-aside>
					<!-- 主体 -->
					<el-main>
						<iframe id="mainIframe" class="mainFrame" :src="iframeUrl" width="100%" height="100%"
							frameborder="0" scrolling="no"></iframe>
					</el-main>
					<el-drawer title="我是标题" :visible.sync="drawer" :with-header="false">
						<span>我来啦!</span>
					</el-drawer>

				</el-container>
			</el-container>
		</div>
	</body>
	<script src="../../assets/js/vue.js"></script>
	<script src="../../assets/css/element-ui/index.js"></script>
	<script src="../../assets/js/axios.min.js"></script>
	<script>
		new Vue({
			el: '#app',
			data: function() {
				return {
					/* src: 'https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg', */
                    drawer: false,
                    innerDrawer: false,
                    UserEditVisible: true,
					editForm: [],
					datalist: [],
					FormData: {},
					isCollapse: true,
					iframeUrl: './index.html',
					fit: 'contain',
					avatarURL: ' ../../assets/pics/logo3.png'
				}
			},
			created() {
                this.getLowWarnList()
			},
			methods: {
				//低库存提醒
				getLowWarnList() {
					axios.get("http://localhost:8080/warning/warn").then(res => {
						if (res.data != null && res.data.length > 0) {
							this.$notify({
								title: '低库存提醒',
								message: '目前仓库内有货物库存量过低哦！',
								position: 'bottom-left',
								type: 'warning'
							});
						}
					});
				},

                handleClose(done) {
                    this.$confirm('还有未保存的工作哦确定关闭吗？')
                        .then(_ => {
                            done();
                        })
                        .catch(_ => {});
                },

				adjustIframe() {
					var ifm = document.getElementById("bi_iframe");
					ifm.height = document.documentElement.clientHeight;
					ifm.width = document.documentElement.clientWidth;
				},
				logout() {
					axios.request("http://localhost:8080/users/logout").then(res => {
						window.location.href = ("../login.html")
					});
				},
				handleOpen(key, keyPath) {
					console.log(key, keyPath);
				},
				handleClose(key, keyPath) {
					console.log(key, keyPath);
				},
				openUrl(url) {

					this.iframeUrl = url;
				}

			}
		})
	</script>

	<script>
		export default {
			data() {
				return {
					drawer: false,
				};
			}
		};
	</script>

</html>
